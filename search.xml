<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Port Scanning</title>
      <link href="/2021/08/21/Port%20Scanning/"/>
      <url>/2021/08/21/Port%20Scanning/</url>
      
        <content type="html"><![CDATA[<h1 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h1><blockquote><p><a href="https://nmap.org/">NMAP</a>（Network Mapper）is a free and open source utility for network discovery and security auditing.</p></blockquote><h2 id="Scan-Types"><a href="#Scan-Types" class="headerlink" title="Scan Types"></a>Scan Types</h2><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">-sT: TCP</span><br><span class="line">-sS: SYN</span><br><span class="line">-sA: ACK</span><br><span class="line">-sU: UDP</span><br><span class="line">-sR: RPC</span><br><span class="line">-sP: ICMP</span><br><span class="line">-sn: Disable port scan, usually for ping scanning</span><br></pre></td></tr></table></figure><p>I usually use these commands, but the bad sides are <strong>time consuming</strong> and <strong>huge amount of requests</strong>.</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">nmap -sS -sV -Pn -vv -p- -A -T4 -O &lt;target&gt;</span><br><span class="line">nmap -sS -sC -sV -oA &lt;NAME&gt;.tcp &lt;target&gt; -v</span><br><span class="line">nmap -sU -sS -sC -sV -oA &lt;NAME&gt;.udp &lt;target&gt; -v </span><br></pre></td></tr></table></figure><h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">-oN &lt;File&gt;</span><br><span class="line">-oX &lt;XML File&gt;</span><br><span class="line">-oG &lt;filespec&gt;</span><br></pre></td></tr></table></figure><p><a href="http://www.unspecific.com/nmap-oG-output/">Grep Reference</a></p><h2 id="T-Options"><a href="#T-Options" class="headerlink" title="-T Options"></a><code>-T</code> Options</h2><ul><li><p><code>-T0</code>: One port at a time.</p></li><li><p><code>-T1</code>: 15 seconds RTT.</p></li><li><p><code>-T2</code>: 0.4 seconds between each requests. Comparing with default option, it uses less bandwidthes and makes less pressures to the servers.</p></li><li><p><code>-T3</code>: Default options, this includes thread scanning.</p></li><li><p><code>-T4</code>: If the server is capable, it increases the scanning speed accrodingly.</p></li><li><p><code>-T5</code>: It sacrifies the accuracy in exchange of the maximum scanning speed.</p></li></ul><h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><ul><li><code>--host-timeout</code>: usually set to 18000</li><li><code>--scan-delay</code>: usually set to 1000</li><li><code>-S</code>: set source address for obsecurity</li><li>Output Beautify</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt install xsltproc</span><br><span class="line">xsltproc -o ip.htm beautiful.xsl ip.xml</span><br></pre></td></tr></table></figure><h1 id="nmapAutomator"><a href="#nmapAutomator" class="headerlink" title="nmapAutomator"></a><a href="https://github.com/21y4d/nmapAutomator">nmapAutomator</a></h1><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">./nmapAutomator &lt;target&gt; All</span><br></pre></td></tr></table></figure><h1 id="AutoRecon"><a href="#AutoRecon" class="headerlink" title="AutoRecon"></a><a href="https://github.com/Tib3rius/AutoRecon">AutoRecon</a></h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">autorecon &lt;IP&gt;&#x2F;CIDR</span><br></pre></td></tr></table></figure><h1 id="Yujian"><a href="#Yujian" class="headerlink" title="Yujian"></a>Yujian</h1><p><a href="https://pan.baidu.com/share/init?surl=Uh-FWsXOUlVUM3ZOpRWoYQ">Yujian High Speed Port Scanner</a> (Code: czne). </p><p><strong>ATTENTION</strong>: default threading is too high.</p><h1 id="Masscan"><a href="#Masscan" class="headerlink" title="Masscan"></a><a href="https://github.com/robertdavidgraham/masscan">Masscan</a></h1><h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><ul><li>The fastest scanner in the worlds. It is capable to scan all the ports in 3 minutes.</li><li>Comparing with Nmap, it is much faster. It uses <strong>asynchronous transmission</strong> and <strong>stateless scanning</strong>.</li><li>A complete TCP connection is not established. A <code>RST</code> packet will be sent once it receives a <code>SYN/ACK</code> packet. (Exception for <code>--banners</code> option)</li><li>Nmap needs to record the status of TCP/IP, and the TCP/IP connection that OS can handle at the same time is only up to about 1500.</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">masscan --ping 28.41.0.0&#x2F;16 --rate 1000000 # Ping scans for probing</span><br><span class="line">masscan -iL tmp_scanip_list.tmp -p1-65535 -Pn -v --randomize-hosts --banners -ox result.xml --rate 100000</span><br></pre></td></tr></table></figure><ul><li>It may encounter device interferences, so that there are too many port are open.</li></ul><h2 id="Advanced-Options"><a href="#Advanced-Options" class="headerlink" title="Advanced Options"></a>Advanced Options</h2><ul><li><code>--adapter-ip</code>: set the source IP address</li><li><code>--adapater-port</code>: set the source port</li><li><code>--adapter-mac</code>: set the source MAC address</li><li><code>--router-mac</code>: set the gateway MAC address</li><li><code>--exclude</code>: set IP blacklists to prevent from scanning</li><li><code>--excludefile</code>: set IP blacklists from a file</li><li><code>--includefile, -iL</code>: scan specific IPs from a file</li><li><code>--wait</code>: set wait time after each packet sent, default 10 seconds.</li></ul><h1 id="Online-Port-Scanning"><a href="#Online-Port-Scanning" class="headerlink" title="Online Port Scanning"></a>Online Port Scanning</h1><ul><li><a href="https://pentest-tools.com/network-vulnerability-scanning/udp-port-scanner-online-nmap">Nmap UDP Scan</a></li><li><a href="https://pentest-tools.com/network-vulnerability-scanning/tcp-port-scanner-online-nmap">Nmap TCP Scan</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Red Team </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Information Gathering - Enumeration </tag>
            
            <tag> Post-Exploitation </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
